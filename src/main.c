#include <GL/glut.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define POINTS 500
#define HEIGHT 500
#define WIDTH 500

double x[POINTS] = { 414, 142, 241, 200, 408, 493, 401, 405, 492, 262, 454, 216, 322, 119, 356, 431, 403, 81, 360, 153, 82, 475, 100, 434, 155, 202, 353, 135, 383, 22, 250, 388, 30, 467, 413, 127, 314, 417, 373, 20, 255, 265, 120, 249, 423, 98, 302, 479, 17, 204, 372, 500, 481, 258, 392, 455, 52, 328, 242, 243, 87, 304, 139, 178, 371, 212, 400, 125, 280, 18, 71, 247, 497, 349, 448, 418, 32, 182, 110, 218, 229, 170, 375, 252, 176, 68, 438, 398, 76, 446, 357, 174, 108, 4, 201, 395, 456, 361, 167, 165, 171, 15, 152, 404, 486, 295, 177, 50, 358, 166, 206, 58, 338, 394, 407, 143, 193, 33, 34, 335, 154, 366, 429, 103, 285, 74, 268, 281, 99, 232, 273, 341, 474, 238, 424, 11, 12, 240, 2, 149, 91, 464, 21, 3, 470, 63, 198, 148, 499, 466, 411, 336, 312, 386, 251, 117, 332, 347, 145, 64, 274, 210, 88, 175, 278, 374, 384, 477, 237, 80, 415, 244, 112, 109, 321, 463, 387, 330, 333, 24, 420, 53, 111, 29, 277, 19, 66, 124, 164, 211, 158, 316, 147, 208, 101, 412, 478, 294, 104, 406, 194, 491, 363, 69, 396, 397, 84, 26, 473, 442, 315, 38, 317, 382, 362, 256, 13, 140, 128, 445, 364, 86, 94, 215, 102, 161, 296, 217, 301, 306, 308, 65, 156, 197, 292, 49, 269, 369, 339, 452, 85, 115, 287, 159, 207, 126, 451, 55, 185, 70, 248, 457, 184, 14, 28, 352, 51, 253, 476, 437, 444, 96, 286, 118, 246, 482, 213, 180, 290, 43, 48, 267, 199, 134, 391, 39, 172, 289, 288, 44, 367, 365, 343, 390, 113, 132, 41, 433, 72, 257, 436, 10, 95, 435, 221, 422, 36, 305, 279, 54, 443, 254, 303, 427, 16, 106, 90, 489, 450, 488, 453, 440, 47, 146, 496, 5, 484, 324, 75, 150, 130, 441, 137, 430, 469, 310, 439, 447, 220, 35, 271, 67, 468, 173, 190, 138, 494, 276, 89, 485, 144, 31, 260, 223, 266, 291, 231, 92, 342, 350, 6, 151, 487, 327, 421, 7, 311, 345, 399, 259, 40, 416, 495, 483, 236, 337, 131, 354, 230, 320, 326, 370, 239, 380, 340, 378, 62, 222, 283, 329, 471, 245, 300, 162, 196, 459, 57, 93, 293, 227, 45, 264, 136, 298, 377, 59, 462, 160, 389, 272, 195, 344, 9, 46, 228, 42, 8, 233, 141, 428, 325, 168, 203, 393, 219, 56, 402, 179, 83, 186, 23, 226, 181, 359, 376, 458, 61, 97, 263, 461, 323, 187, 346, 270, 25, 381, 465, 205, 37, 318, 192, 282, 123, 409, 261, 121, 284, 419, 189, 122, 297, 472, 355, 129, 498, 209, 163, 307, 351, 79, 188, 368, 225, 234, 114, 235, 27, 157, 449, 191, 334, 275, 169, 224, 1, 426, 460, 319, 77, 410, 385, 480, 133, 432, 313, 60, 116, 425, 299, 379, 107, 490, 78, 73, 309, 214, 183, 331, 105, 348   };
double y[POINTS] = { 215, 274, 473, 484, 300, 192, 406, 273, 151, 146, 344, 217, 400, 309, 56, 425, 3, 231, 288, 493, 57, 136, 132, 180, 230, 395, 153, 91, 255, 437, 382, 76, 233, 428, 122, 173, 410, 260, 148, 462, 326, 332, 107, 34, 26, 450, 73, 448, 303, 415, 203, 155, 251, 401, 264, 337, 38, 436, 234, 13, 392, 499, 380, 286, 377, 479, 207, 374, 243, 409, 370, 101, 183, 241, 444, 109, 23, 44, 184, 340, 470, 42, 150, 366, 120, 81, 218, 125, 261, 283, 134, 121, 213, 298, 339, 97, 419, 116, 335, 32, 269, 17, 31, 108, 191, 246, 258, 171, 367, 52, 405, 329, 492, 372, 221, 416, 387, 103, 181, 313, 72, 208, 50, 348, 235, 93, 68, 299, 376, 188, 460, 37, 119, 328, 214, 295, 126, 82, 472, 245, 379, 284, 263, 439, 385, 323, 64, 189, 144, 252, 256, 29, 358, 333, 412, 92, 149, 124, 480, 301, 69, 100, 266, 447, 163, 127, 388, 90, 211, 254, 40, 296, 408, 139, 113, 491, 55, 453, 70, 164, 373, 48, 112, 467, 422, 350, 308, 331, 403, 200, 240, 433, 16, 223, 96, 421, 161, 427, 20, 496, 417, 4, 413, 190, 168, 307, 84, 250, 341, 15, 275, 22, 10, 281, 2, 129, 154, 8, 389, 77, 485, 393, 11, 289, 468, 440, 196, 87, 397, 438, 66, 143, 384, 282, 41, 312, 469, 159, 317, 396, 5, 83, 455, 94, 88, 85, 80, 486, 28, 195, 319, 290, 229, 362, 278, 277, 212, 131, 35, 346, 477, 430, 18, 411, 431, 287, 27, 481, 394, 294, 500, 478, 21, 86, 187, 268, 482, 216, 369, 79, 321, 74, 464, 475, 236, 456, 305, 402, 53, 465, 141, 170, 7, 247, 244, 114, 446, 334, 225, 279, 162, 130, 228, 306, 253, 463, 487, 115, 209, 99, 267, 232, 352, 315, 14, 179, 353, 327, 111, 198, 426, 291, 270, 133, 75, 43, 330, 166, 193, 137, 238, 174, 224, 357, 49, 67, 19, 30, 259, 65, 271, 239, 391, 390, 45, 324, 63, 226, 210, 375, 158, 172, 165, 46, 60, 495, 78, 302, 169, 227, 167, 54, 423, 276, 257, 349, 318, 458, 451, 404, 489, 297, 152, 418, 1, 461, 429, 219, 459, 175, 432, 488, 135, 490, 342, 474, 449, 360, 51, 220, 262, 25, 351, 356, 249, 104, 420, 443, 381, 399, 24, 292, 98, 142, 156, 304, 435, 471, 434, 407, 204, 424, 160, 368, 201, 494, 498, 12, 106, 338, 6, 265, 199, 457, 454, 359, 314, 398, 336, 59, 128, 285, 371, 442, 316, 178, 147, 61, 237, 476, 39, 89, 222, 386, 118, 95, 310, 117, 33, 202, 36, 206, 185, 497, 140, 47, 102, 157, 365, 355, 414, 280, 123, 361, 145, 71, 343, 62, 293, 110, 325, 320, 176, 194, 205, 248, 345, 347, 138, 58, 441, 466, 186, 445, 242, 182, 363, 364, 197, 452, 354, 105, 483, 378, 177, 272, 9, 383, 322, 311   };
int height[HEIGHT];
int width[WIDTH];

int saveColor[HEIGHT][WIDTH];

unsigned char rgb[POINTS*3];

GLsizei wh = HEIGHT ; // initial height of window
GLsizei ww = WIDTH ; // initial width of window


void draw()
{
	glClear ( GL_COLOR_BUFFER_BIT ); //clear pixel buffer

	int i,j,k;

	for(i = 0; i < HEIGHT; i++){
		for(j = 0; j < WIDTH; j++){

			for(k = 0; k < POINTS; k++){
				if(saveColor[i][j] == k){
					glBegin(GL_POINTS); // render with points
					glColor3ub(rgb[k*3],rgb[k*3+1],rgb[k*3+2]); // die Farbe setzt sich aus drei aufeinanderfolgenden Werten im Array zusammen
					glVertex2i(width[j],height[i]);
					glEnd();
				}
			}
		}
	}

	// draw POINTS
	glPointSize(2.0f);
	glBegin(GL_POINTS);
	glColor3f(0.0f, 0.0f,0.0f); // black drawing color
	for(i = 0; i < POINTS; i++){
		glVertex2i(x[i],y[i]);
	}
	glEnd();

	glFlush();
}

void MyInit () {
	glClearColor ( 1.0, 1.0, 1.0, 0.0 ); //white background
	glMatrixMode ( GL_PROJECTION );
	glLoadIdentity ( );
	gluOrtho2D(0.0,(GLdouble)ww,0.0,(GLdouble)wh);
}

double calculateDistance (double x1,double y1,double x2 ,double y2) {
	return sqrt(((x1-x2) * (x1-x2)) + ((y1-y2) * (y1-y2)));
}
int resetDistance(){
	return HEIGHT*WIDTH;
}

#define frand(x) (rand() / (1. + RAND_MAX) * x)
int main(int argc, char **argv)
{

	int i,j,k;
	double distance;
	double tempDistance = resetDistance();

	// fill width and height. (its only possible, cause height and width is the same!)
	for(i = 0; i < WIDTH; i++){
		width[i] = i;
		height[i] = i;
	}

	//generate random colors
	for(i = 0; i < POINTS*3; i++){
		rgb[i] = frand(256);
	}

	// iterate through each pixel from HEIGHT x WEIGHT and calculate the distance to our given points.
	for(i = 0; i < HEIGHT; i++){
		for(k = 0; k < WIDTH; k++){
			for(j = 0; j < POINTS; j++){
				distance = calculateDistance(width[k],height[i],x[j],y[j]);
				if (distance < tempDistance){
					tempDistance = distance;
					saveColor[i][k] = j;
				}
			}
			tempDistance = resetDistance();
		}
	}


	// OpenGL stuff
	glutInit ( &argc, argv );
	glutInitDisplayMode ( GLUT_SINGLE | GLUT_RGB );
	glutInitWindowSize ( ww, wh );
	glutInitWindowPosition ( 100, 100 );
	glutCreateWindow("Voronoi");
	MyInit();
	glutDisplayFunc ( draw );
	glutMainLoop ();

return 0;
}
